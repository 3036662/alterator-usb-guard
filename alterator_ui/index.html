<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html wf="none">
    <head>
      <link type="text/css" rel="stylesheet" href="/design/styles/alt_usb_guard.css" />
      <script src="/design/scripts/alt-usb-guard.js" />
    </head>
    <body>
      <div class="config_check">
        <form method="POST">
          <!-- status guard is OK-->
          <div name="guard_status_ok" class="service_status">
            <svg>
              <circle cx="10" cy="10" r="8" fill="green" />
            </svg>
            <span>UsbGuard service ... ACTIVE</span>
          </div>
          <!-- status guard is BAD-->
          <div name="guard_status_bad" class="service_status">
            <svg>
              <circle cx="10" cy="10" r="8" fill="red" />
            </svg>
            <span>UsbGuard service ... </span> 
              <span>Autorun is 
              <input class="no_border" name="usbguard_enabled" readonly="readonly" size="10" />
              </span> 
              <span>Process is
              <input class="no_border" name="usbguard_active" readonly="readonly" size="10"/>
              </span>
           
          </div>
          <!-- status udev is OK-->
          <div name="udev_status_ok" class="service_status">
            <svg>
              <circle cx="10" cy="10" r="8" fill="green" />
            </svg>
            <span>Udev rules ... OK</span>
          </div>
           <!-- status udev is not OK-->
          <div name="udev_status_warnig" class="service_status">
            <svg>
              <circle cx="10" cy="10" r="8" fill="yellow" />
            </svg>
            <span>Udev rules ... WARNING</span>
          </div>
          <div class="config_check_header">
            <p>Users are allowed to change rules: 
              <input class="no_border" name="usbguard_users" readonly="readonly"  />
            </p>
            <p>Groups are allowed to change rules: 
              <input class="no_border" name="usbguard_groups" readonly="readonly"  />
            </p> 
          </div>
          <!-- warnigs for udev-->
          <div class="config_check_header" name="udev_config_warinigs">
            <span class="warning">Warning!</span>
            <p>Suspicious files were found in udev config folders.</p> 
            <p>It may cause undefined behavior.</p>
            <p>Please double-check before configuring.</p>
          </div>
          <table class="alterator-listbox" align="center" name="suspicious_udev_files">
            <thead>
              <tr>
                <th>Filename</th>
              </tr>
            </thead>
            <tbody>
              <td><span class="alterator-label" name="name" /></td>
            </tbody>
          </table>
          <!-- checkbox  Use usb ports control-->
          <div>
            <input type="hidden" id="checkbox_use_control_hidden" name="checkbox_use_control_hidden" /> 
            <input type="checkbox" id="checkbox_use_control" name="checkbox_use_control" />
            <label for="use_usb_control">Use usb ports control</label> 
          </div>
        </form>
      </div>
      <hr />
      <!-- Devices list -->
      <form method="POST">
        <table id="devices_list_table" class="alterator-listbox single-select" align="center" name="list_prsnt_devices">
          <p>Connnected usb devices:</p>
          <caption>List of devices</caption>  
          <thead>
              <tr>
                <th>N</th>
                <th>Port</th>
                <th>CC:SS:PP</th>
                <th>VID</th>
                <th>Vendor</th>
                <th>PID</th>
                <th>Product</th>
                <th>SN</th>
                <th>Hash</th>
                <th>Status</th>
                <!-- <th>Connect type</th> -->
               </tr>
          </thead>
          <tbody>              
                  <tr class="wrap">
                    <td><span class="alterator-label" name="name" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_port" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_class" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_vid" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_vendor" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_pid" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_name" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_serial" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_hash" /></td>
                    <td><span class="alterator-label" name="label_prsnt_usb_status" /></td>
                   <!-- <td><span class="alterator-label" name="label_prsnt_usb_connection" /></td>-->
                  </tr>
          </tbody>
        </table>
        <div name="usb_buttons" class="right_buttons">
                  <input type="button" name="btn_prsnt_scan" class="btn" value="Scan plugged-in USB devices"/>&nbsp;&nbsp;
                  <input type="button" name="btn_prsnt_dev_add" class="btn" value="Allow device"/>
                  <input type="button" name="btn_prsnt_dev_block" class="btn" value="Block device"/>
        </div>
      </form>
      
      
      <!-- Radio buttons -->
      <form name="form_presets" id="form_presets">
        <fieldset>
          <legend>Presets</legend>
          <p><input type="radio" id="preset1" name="presets" value="put_connected_to_white_list" />
          <label for="preset1">Block everything except connected devices.</label>
          </p>
          <p><input type="radio" id="preset2" name="presets" value="put_connected_to_white_list_plus_HID" />
          <label for="preset1">Block everything except connected and HID/DUB devices.</label></p>
          <p>
          <input type="radio" id="preset3" name="presets" value="put_disks_and_mtp_to_black" />
          <label for="preset1">Block only USB Mass Storage, MTP/PTP.</label>
          </p>
          <p><input type="radio" id="preset3" name="presets" value="block_and_reject_android" />
          <label for="preset1">Block and reject only Android devices.</label></p>
          <p><input type="radio" id="preset4" name="presets" value="manual_mode" />
          <label for="preset4">Manual mode</label></p>
          <input type="hidden" name="presets_input_hidden" id="presets_input_hidden" />
        </fieldset>
        <fieldset id="radio_list_type">
          <legend>Rules lists:</legend>
          <p><input type="radio" id="radio_black_list" name="list_type" value="radio_black_list" />
          <label for="preset1">"Black" list (allow all,except listed).</label>
          </p>
          <p><input type="radio" id="radio_white_list" name="list_type" value="radio_white_list" />
          <label for="preset1">"White" list (block all, except listed).</label>
          </p>
          <input type="hidden" name="hidden_list_type" id="hidden_list_type"/>
         </fieldset>  
      </form>
      <!-- Rules non-strict(non sorted) -->
      <form name="form_list_unsorted_rules" id="form_list_unsorted_rules" class="form_rules" method="POST" onsubmit="return false;">
        <table class="alterator-listbox multi-select" align="center" name="list_unsorted_rules" id="list_unsorted_rules">
          <caption>Unsorted rules</caption>
          <thead>
            <tr>
              <th>N</th>
              <th>Rule</th>
              <th>Allow</th>
            </tr>
          </thead>
          <tbody>
            <tr class="wrap">
              <td><span class="alterator-label" name="name" /></td>
              <td><span class="alterator-label" name="lbl_rule_raw" /></td>
              <td><span class="alterator-label" name="lbl_rule_target" /></td>
            </tr>
          </tbody>
        </table>
        <div name="list_interface_rules_buttons" class="right_buttons">
          <input type="button" name="" class="btn" value="Add" id="add_to_rules_unsorted" />
          <input type="button" name="" class="btn" id="delete_rules_from_unsorted_level" value="Delete"/>
        </div>
      </form>

      <!-- Rules by interface-->
      <form name="form_list_interface_rules" id="form_list_interface_rules" class="form_rules" method="POST" onsubmit="return false;">
        <table class="alterator-listbox multi-select" align="center" name="list_interface_rules" id="list_interface_rules">
          <caption>Masks CC:SS:PP</caption>
          <thead>
            <tr>
              <th>N</th>
              <th>CC:SS:PP</th>
              <th>Description</th>
              <th>Port</th>
              <th>Allow</th>
            </tr>
          </thead>
          <tbody>
            <tr class="wrap">
              <td><span class="alterator-label" name="name" /></td>
              <td><span class="alterator-label" name="lbl_rule_interface" /></td>
              <td><span class="alterator-label" name="lbl_rule_desc" /></td>
              <td><span class="alterator-label" name="lbl_rule_port" /></td>
              <td><span class="alterator-label" name="lbl_rule_target" /></td>
            </tr>
          </tbody>
        </table>
        <div name="list_interface_rules_buttons" class="right_buttons">
          <input type="button" name="" class="btn" value="Add" id="add_to_rules_interfase"/>
          <input type="button" name="" class="btn" id="delete_rules_from_interface_level" value="Delete"/>
        </div>
      </form>

      <!-- VID/PID Rules -->
      <form name="form_list_vidpid_rules" id="form_list_vidpid_rules" class="form_rules" method="POST" onsubmit="return false;">
        <table class="alterator-listbox multi-select" align="center" name="list_vidpid_rules" id="list_vidpid_rules">
          <caption>Masks VID:PID</caption>
          <thead>
            <tr>
              <th>N</th>
              <th>VID</th>
              <th>Vendor</th>
              <th>PID</th>
              <th>Product</th>
              <th>Port</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr class="wrap">
              <td><span class="alterator-label" name="name" /></td>
              <td><span class="alterator-label" name="lbl_rule_vid" /></td>
              <td><span class="alterator-label" name="lbl_rule_vendor" /></td>
              <td><span class="alterator-label" name="lbl_rule_pid" /></td>
              <td><span class="alterator-label" name="lbl_rule_product" /></td>
              <td><span class="alterator-label" name="lbl_rule_port" /></td>
              <td><span class="alterator-label" name="lbl_rule_target" /></td>
            </tr>
          </tbody>
        </table>
        <div name="list_vidpid_rules_buttons" class="right_buttons">
          <input type="button" name="" class="btn" value="Add" id="add_to_rules_vidpid"/>
          <input type="button" name="" class="btn" id = "delete_rules_from_vid_pid_level" value="Delete"/>
        </div>
      </form>

      <!-- Rules by hash-->
      <form name="form_list_hash_rules" id="form_list_hash_rules" class="form_rules" method="POST" onsubmit="return false;">
        <table class="alterator-listbox multi-select" align="center" name="list_hash_rules" id="list_hash_rules">
          <caption>Mask Hash</caption>
          <thead>
            <tr>
              <th>N</th>
              <th>Hash</th>
              <th>Description</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr class="wrap">
              <td><span class="alterator-label" name="name" /></td>
              <td><span class="alterator-label" name="lbl_rule_hash" /></td>
              <td><span class="alterator-label" name="lbl_rule_desc" /></td>
              <td><span class="alterator-label" name="lbl_rule_target" /></td>
            </tr>
          </tbody>
        </table>
        <div name="list_hash_rules_buttons" class="right_buttons">
          <input type="button" name="load_file_button" id="load_file_button" class="btn" value="Load from file"/>
          <input type="file" name="file_input" id="file_input" accept=".csv"/>
          <input type="hidden" name="hidden_file_uplod_response" id = "hidden_file_uplod_response"/>  
          <input type="button" name="" class="btn" value="Add" id="add_to_rules_hash"/>
          <input type="button" name="" class="btn" value="Delete" id="delete_rules_from_hash_level" />
        </div>
      </form>
    <div id="module_footer">  
      <hr />
        <form onsubmit="return false;">
          <input type="hidden" name="hidden_manual_changes_data" id = "hidden_manual_changes_data"/>
          <input type="hidden" name="hidden_manual_changes_response" id = "hidden_manual_changes_response"/>  
          <input class="right_buttons btn" type="button" name="save_rules" id="save_rules_button" value="SAVE ALL RULES" />
        </form>
      </div>
    </body>
</html>
